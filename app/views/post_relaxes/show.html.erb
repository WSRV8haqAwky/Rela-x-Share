 <main>
  <p id="notice"><%= flash[:notice] %></p>

  <div class='container px-5 px-sm-0'>
    <div class='row'>
      <div class='col-md-3'>
        <h2>プロフィール</h2>
        <%= render 'users/profile', user: @user %>

        <% if @post_relax.user == current_user %>
          <div class='row mt-3'>
            <%= link_to "新規投稿", new_post_relax_path(@post_relax), class: "btn btn-success btn-block" %>
          </div>
        <% end %>
      </div>

      <div class='col-md-8 offset-md-1'>
        <div class="col-lg-6 col-md-8 col-sm-10 mt-5">
          <div class="card mx-auto h-100">
            <%= attachment_image_tag @post_relax, :image, class:"card-img-top"; %>
              <div class="card-body">
                <div class="row">
                  <div class="col-3">
                    <%= attachment_image_tag @post_relax.user, :profile_image, :fill, 60, 60, fallback: "default-image.jpg", size: '60x60', class:"mt-3 rounded-circle"; %>
                  </div>
                  <div class="col-9">
                    <p class="card-text"><%= @post_relax.caption %></p>
                    <span><i class="fas fa-user"></i><%= @post_relax.user.name %> ｜ </span>
                    <span><%= @post_relax.created_at.strftime('%Y/%m/%d') %> 投稿</span>
                  </div>
                </div>
              </div>
          </div>
        </div>
            <% if @post_relax.user == current_user %>
              <%= link_to "編集", edit_post_relax_path(@post_relax), class: "btn btn-success" %>
              <%= link_to "削除", post_relax_path(@post_relax), method: :delete, "data-confirm" => "本当に消しますか?", class: "btn btn-danger" %>
            <% end %>

            <% if @post_relax.favorited_by?(current_user) %>
              <p>
                <%= link_to post_relax_favorites_path(@post_relax), method: :delete do %>
                  ★<%= @post_relax.favorites.count %>
                <% end %>
              </p>
              <% else %>
              <p>
                <%= link_to post_relax_favorites_path(@post_relax), method: :post do %>
                  ☆<%=  @post_relax.favorites.count %>
                <% end %>
              </p>
            <% end %>

            <div class="row">
              <div class="col-4">
                <h2>コメント</h2>
                <%= form_with(model:[@post_relax, @post_comment], local: true) do |f| %>
                  <div class="form-group">
                    <%= f.text_area :comment, rows:'5',placeholder: "コメントをここに", class:"form-control" %>
                  </div>
                  <div class="form-group">
                    <%= f.submit "送信する", class:"btn btn-success" %>
                  </div>
                <% end %>
              </div>

              <div class="col-8">
                <p>コメント件数：<%= @post_relax.post_comments.count %></p>
                  <table class="table">
                    <tbody>
                      <% @post_relax.post_comments.each do |post_comment| %>
                        <tr>
                          <td>
                            <%= link_to user_path(@user.id) do %>
                              <%= attachment_image_tag @post_comment.user, :profile_image, :fill, 80, 80, fallback: "default-image.jpg",size:'80x80', class:"rounded-circle" %>
                            <% end %>
                              <br>
                               <%= post_comment.created_at.strftime('%Y/%m/%d') %>
                          </td>
                          <td>
                             <%= post_comment.user.name %>
                             <br>
                             <%= post_comment.comment %>
                          </td>
                          <% if post_comment.user == current_user %>
      　　　　             　　　  <td>
      　　　　             　　　　　<%= link_to "削除", post_relax_post_comment_path(post_comment.post_relax, post_comment), method: :delete %>
      　　　　             　　　  </td>
　                  　　  <% end %>
                        </tr>
                      <% end %>
                    </tbody>
                  </table>
              </div>
            </div>
      </div>
    </div>
  </div>
</main>